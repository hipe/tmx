module Skylab::MyTerm

  class CLI

    module Interactive

      class << self

        def build_classesque__

          Require_zerk_[]

          cli = Zerk_::Interactive_CLI.begin

          cli.root_ACS = -> & _ignore_top_oes_p do  # #cold-model
            Home_.build_root_ACS_
          end

          cli.design = -> vmm do
            vmm.compound_frame = vmm.common_compound_frame
            vmm.custom_tree_array_proc = CUSTOM_TREE___
            vmm.location = vmm.common_location
            vmm.primitive_frame = vmm.common_primitive_frame
            vmm
          end

          cli.to_classesque
        end
      end  # >>

      # ==

      adapter_changed = nil

      CUSTOM_TREE___ = -> do
        [
          :children, {

            adapter: -> do
              [
                :hotstring_delineation, [nil, 'a', 'dapter'],
                :on_change, adapter_changed,
              ]
            end,

            adapters: -> do
              [
                :hotstring_delineation, ['adapter', 's', nil],
              ]
            end,

            bg_font: -> do
              []  # [ :mask ]  # is [#ze-041]
            end,

            eg_compound_1: -> do
              [
                :children, {
                  eg_primi_1: -> do
                    [
                      :hotstring_delineation, [xx],
                      :custom_view_controller, -> * a do
                        Home_::CLI::Inveractive.new( * a )
                      end,
                    ]
                  end,
                },
              ]
            end,
          },
        ]
      end

      # ==

      adapter_changed = -> adapter_frame do

        # "appearance" is the root frame and it has as one of its immediate
        # children nodes the "adapter" atomesque. subject is called when
        # that component value has changed. when this happens we need to
        # let the modality know so that it can do whatever re-indexing or
        # clearing of caches (etc) is necessary to reflect this change in
        # its generated UI (so that newly available component (tickets)
        # appear).

        root_frame = adapter_frame.below_frame

        root_frame.CHANGE_ACS root_frame.ACS.adapter.implementation_

        NIL_
      end
    end
  end
end
