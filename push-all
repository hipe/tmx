#!/usr/bin/env ruby
#

require 'fileutils'
require 'optparse'

module GitRepoAdmin
  module Push
    class Cli
      def run argv
        argv = argv.dup
        req = {}
        ui = Struct.new(:out, :err).new($stdout, $stderr)
        op = OptionParser.new do |o|
          o.banner = "usage: #{File.basename $PROGRAM_NAME}"
          o.on('-n', '--dry-run', 'Dry run.') { req[:dry_run] = true }
        end
        begin
          op.parse!(argv)
        rescue OptionParser::ParseError => e
          ui.err.puts "#{e}"
          ui.err.puts "#{op}"
          return false
        end
        Api.new(ui, req).run
      end
    end
    class Api
      def initialize *a
        @ui, @req = a
      end
      attr_reader :req, :ui
      def run
        ui.err.puts "ok sure"
      end
    end
  end
end

GitRepoAdmin::Push::Cli.new.run(ARGV)

